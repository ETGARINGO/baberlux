<h2>King of Fadez POS</h2>
<input id="name" placeholder="Customer Name">
<div id="items"></div>
<h3>Total ₱<span id="total">0</span></h3>
<button onclick="pay()">PAY</button>

<script>
const API = "https://script.google.com/macros/s/AKfycbzeVWLFNnLdZmBzr3RWX4qyNMnt4sSjgZveDZ69NoRGEvtYV0PWfoSf8FOKzJziQAoCTQ/exec";
let prices=[];

fetch(API+"?mode=sync").then(r=>r.json()).then(d=>{
 prices=d.prices;
 d.prices.forEach(p=>{
  items.innerHTML+=`<label>
   <input type=checkbox value="${p[1]}" onchange="calc()">
   ${p[1]} ₱${p[2]}</label><br>`;
 });
});

function calc(){
 let t=0;
 document.querySelectorAll("input:checked").forEach(i=>{
  prices.forEach(p=>{ if(p[1]==i.value) t+=Number(p[2]); });
 });
 total.innerText=t;
}

function pay(){
 let items=[...document.querySelectorAll("input:checked")].map(i=>i.value);
 fetch(API,{method:"POST",body:JSON.stringify({
   name:name.value,
   phone:"",
   items:items,
   source:"POS"
 })}).then(r=>r.json()).then(d=>{
  alert("PAID ₱"+d.total);
  location.reload();
 });
}
</script>
