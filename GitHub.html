<h2>King of Fadez POS</h2>
<input id="name" placeholder="Customer Name">
<div id="items"></div>
<h3>Total ₱<span id="total">0</span></h3>
<button onclick="pay()">PAY</button>

<script>
const API = "https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLjkGvzVYvbPeQ2zWBAr7ggChQy19_wYOVsIG5FuhqGtHNQ5x1UwVk9P-qNTa8UWDe1lYCoITaKvFaJc4W3Vbh9bO3bDzN5FflaLttnTf0YOxvUgnJkK2l0K9p7jJo-EEb9TgoCsHt_VvMYjF2W6j7ApYhWjNSSEV1cvsZKg4bIcNqGKiOHO_0DxRq22vYL-y9kgH93wkTK1l_xYov1qc7RJ4W-D9y3KkCg9Xc9dCT0a1-OeLwLa0lYj919pd9KkqiBZilMfe3p937cH9HKWxD8khxLob2L9p4Zwr_8za3P42LLq_NE&lib=MjZEu5OeLOsYeIB_9O81nzE-1Fl2FkoVJ";
let prices=[];

fetch(API+"?mode=sync").then(r=>r.json()).then(d=>{
 prices=d.prices;
 d.prices.forEach(p=>{
  items.innerHTML+=`<label>
   <input type=checkbox value="${p[1]}" onchange="calc()">
   ${p[1]} ₱${p[2]}</label><br>`;
 });
});

function calc(){
 let t=0;
 document.querySelectorAll("input:checked").forEach(i=>{
  prices.forEach(p=>{ if(p[1]==i.value) t+=Number(p[2]); });
 });
 total.innerText=t;
}

function pay(){
 let items=[...document.querySelectorAll("input:checked")].map(i=>i.value);
 fetch(API,{method:"POST",body:JSON.stringify({
   name:name.value,
   phone:"",
   items:items,
   source:"POS"
 })}).then(r=>r.json()).then(d=>{
  alert("PAID ₱"+d.total);
  location.reload();
 });
}
</script>
